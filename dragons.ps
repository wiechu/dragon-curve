%!PS
%%BoundingBox: 0 0 720 720

% author: wiechu
% description: *real* dragon curve

/level 13 def

/rotation 0 def

/R 2 def

/x0 360 def
/y0 360 def

2 sqrt R mul /A exch def

.2 setlinewidth

/F {
  dup -90 mul rot add /rot exch def

  dup -45 mul 135 add rot add
  rot cos R mul x add exch
  rot sin R mul y add exch
  R exch
  dup 90 add
  arc stroke

  dup 45 mul rot add cos A mul x add /x exch def
  dup 45 mul rot add sin A mul y add /y exch def

  pop
} def

/dragon {
  dup 1 le
  {
    1 index F
  }
  {
    dup 1 sub 1 exch dragon

    1 index 1 dragon

    dup 1 sub -1 exch dragon
  }
  ifelse
  pop pop
} def

/start {
  rotation add /rot exch def
  x0 R rot cos mul add /x exch def
  y0 R rot sin mul add /y exch def
  x y moveto
  newpath 1 level dragon
} def

%
% Let's rock
%
.8 0 0 setrgbcolor
0 start

0 0 0 setrgbcolor
90 start

0 0 .8 setrgbcolor
180 start

0 0.7 0 setrgbcolor
270 start

showpage
%%END
